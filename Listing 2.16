--Table Function f√ºr multiple Werte aus SALES-Daten
FUNCTION " MY_TABLE_FUNCTION" ( 
IN IP_MEIN_KUNDE nvarchar(5000)
)

RETURNS TABLE (
SID INTEGER,
KUNDE INTEGER,
PID INTEGER,
VK_WERT_BILL DECIMAL(15,2)
)
       
LANGUAGE SQLSCRIPT
SQL SECURITY INVOKER
DEFAULT SCHEMA MY_SCHEMA 
AS 


BEGIN

declare vfilt_Kunde nvarchar (5000); --Deklaration Hilfsvariable
 
 vfilt_Kunde:=  replace(:IP_MEIN_KUNDE , char(39), '') ;

return   
    select  
          "SID",
          "UID" as "KUND",
          "PID",
          "VK_WERT_BILL"
        
    from  "SALES"
     where "UID" in(select "VAR_LIST" from "MULTIPLE_VAR_INLIST"(:vfilt_Kunde,','));
     
END; 

