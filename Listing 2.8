--Prozedur Schema ermitteln
CREATE PROCEDURE "MY_GET_TABSCHEMA" ( IN p_tabname varchar(256), OUT p_sys nvarchar(256))
   LANGUAGE SQLSCRIPT
   SQL SECURITY INVOKER
   DEFAULT SCHEMA "MEIN_SCHEMA"
   READS SQL DATA AS
   
--Liest HANA-Schema f√ºr angegebene Tabelle aus und liefert Schema- und Tabellenname als String
BEGIN
      DECLARE LV_PHYS nvarchar(256);
  t = SELECT * FROM "_SYS_BI"."M_SCHEMA_MAPPING" where AUTHORING_SCHEMA = 'ABAP';
    select PHYSICAL_SCHEMA into LV_PHYS  from :t;
   p_sys = concat('"',concat(:LV_PHYS,'"."'));    --z. B. "SAPP01"."
   p_sys = concat(p_sys,concat(:p_tabname,'"'));  --z. B. "SAPP01"."MyTable"

END;
